---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Card from '../../components/Card.astro';

// 1. Get all guides from the 'data-tools' collection
const guides = await getCollection('data-tools');

// 2. Sort them by the 'order' property we defined in the markdown files
guides.sort((a, b) => a.data.order - b.data.order);

const iconMap = {
    'Power Query': 'fa-solid fa-file-excel',
    'DuckDB': 'fa-solid fa-database',
    'GraphRAG': 'fa-solid fa-diagram-project'
}
---
<BaseLayout title="Data Tool Analyzer" description="A hub for comparing data analysis tools.">
    <header class="text-center my-12">
        <h1 class="text-4xl font-bold text-gray-900">Data Tool Analysis Hub</h1>
        <p class="mt-2 text-lg text-gray-600">An interactive guide to choosing the right tool for your data needs.</p>
    </header>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <Card
            title="General Comparison"
            description="A high-level, side-by-side comparison of features for GraphRAG, Power Query, and DuckDB."
            href="/data-tools/comparison"
            icon="fa-solid fa-table-list"
        />

        <!-- 3. Loop through the sorted guides and create a card for each one -->
        {guides.map(guide => (
            <Card
                title={guide.data.title}
                description={guide.data.description}
                href={`/data-tools/guides/${guide.slug}`}
                icon={iconMap[guide.data.title.split(' ').pop()] || 'fa-solid fa-book'}
            />
        ))}
    </div>
</BaseLayout>
